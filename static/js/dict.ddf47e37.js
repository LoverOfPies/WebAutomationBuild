(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dict"],{1276:function(e,t,i){"use strict";var n=i("2ba4"),a=i("c65b"),l=i("e330"),s=i("d784"),o=i("44e7"),r=i("825a"),d=i("1d80"),c=i("4840"),u=i("8aa5"),p=i("50c4"),h=i("577e"),f=i("dc4a"),m=i("4dae"),b=i("14c3"),g=i("9263"),v=i("9f7f"),w=i("d039"),y=v.UNSUPPORTED_Y,k=4294967295,F=Math.min,_=[].push,x=l(/./.exec),C=l(_),I=l("".slice),R=!w((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var i="ab".split(e);return 2!==i.length||"a"!==i[0]||"b"!==i[1]}));s("split",(function(e,t,i){var l;return l="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,i){var l=h(d(this)),s=void 0===i?k:i>>>0;if(0===s)return[];if(void 0===e)return[l];if(!o(e))return a(t,l,e,s);var r,c,u,p=[],f=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),b=0,v=new RegExp(e.source,f+"g");while(r=a(g,v,l)){if(c=v.lastIndex,c>b&&(C(p,I(l,b,r.index)),r.length>1&&r.index<l.length&&n(_,p,m(r,1)),u=r[0].length,b=c,p.length>=s))break;v.lastIndex===r.index&&v.lastIndex++}return b===l.length?!u&&x(v,"")||C(p,""):C(p,I(l,b)),p.length>s?m(p,0,s):p}:"0".split(void 0,0).length?function(e,i){return void 0===e&&0===i?[]:a(t,this,e,i)}:t,[function(t,i){var n=d(this),s=void 0==t?void 0:f(t,e);return s?a(s,t,n,i):a(l,h(n),t,i)},function(e,n){var a=r(this),s=h(e),o=i(l,a,s,n,l!==t);if(o.done)return o.value;var d=c(a,RegExp),f=a.unicode,m=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(y?"g":"y"),g=new d(y?"^(?:"+a.source+")":a,m),v=void 0===n?k:n>>>0;if(0===v)return[];if(0===s.length)return null===b(g,s)?[s]:[];var w=0,_=0,x=[];while(_<s.length){g.lastIndex=y?0:_;var R,D=b(g,y?I(s,_):s);if(null===D||(R=F(p(g.lastIndex+(y?_:0)),s.length))===w)_=u(s,_,f);else{if(C(x,I(s,w,_)),x.length===v)return x;for(var P=1;P<=D.length-1;P++)if(C(x,D[P]),x.length===v)return x;_=w=R}}return C(x,I(s,w)),x}]}),!R,y)},"14c3":function(e,t,i){var n=i("da84"),a=i("c65b"),l=i("825a"),s=i("1626"),o=i("c6b6"),r=i("9263"),d=n.TypeError;e.exports=function(e,t){var i=e.exec;if(s(i)){var n=a(i,e,t);return null!==n&&l(n),n}if("RegExp"===o(e))return a(r,e,t);throw d("RegExp#exec called on incompatible receiver")}},"29a8":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("Title",{attrs:{title:e.localTitle,back:"true"}}),i("b-container",{staticClass:"pt-4 pl-4",attrs:{fluid:""}},[i("b-row",[i("b-col",{attrs:{cols:"12"}},[null==e.mode?i("search-bar",{attrs:{filter:e.searchFilter},on:{filterChange:e.onFilterChange}}):e._e(),e.filtersData.model.length?i("Filters",{ref:"filters",attrs:{filtersData:e.filtersData},on:{applyFilters:e.onApplyFilters,resetFilters:e.onResetFilters,filterLabelChange:e.onFilterLabelChange}}):e._e(),null==e.mode?i("Table",{attrs:{parent:e.parent,itemsData:e.itemsData,fieldsData:e.fieldsData,filter:e.searchFilter,isBusy:e.isBusy,perPage:e.perPage,currentPage:e.currentPage,name:e.name,tableSpacing:e.tableSpacing},on:{filtered:e.onTableSearched}}):e._e(),i("b-row",[i("b-col",{attrs:{cols:"12",lg:"10",xl:"8"}},[null!=e.mode&&null==e.groupField?i("SelectGroup",{attrs:{items:e.itemsData,fields:e.fieldsData,id:e.id,name:e.name}}):e._e(),null!=e.mode&&null!=e.groupField?i("RadioGroup",{attrs:{items:e.itemsData,groupField:e.groupField,fields:e.fieldsData,id:e.id,name:e.name}}):e._e()],1)],1),null==e.mode?i("b-row",{staticClass:"pt-2 pb-2"},[i("b-col",{attrs:{cols:"8"}},[i("Pagination",{attrs:{rows:e.localItemRowsLength,perPage:e.perPage,currentPage:e.currentPage},on:{pageChange:e.onPageChange}})],1),i("b-col",{attrs:{cols:"4"}},[i("add-data-btn",{staticClass:"text-end",attrs:{parent:e.parent,parentId:e.id,readOnly:e.isReadOnly,fields:e.fieldsData.list,fieldsModels:e.fieldsData.models},on:{addNewRow:e.onAddNewRow}})],1)],1):e._e()],1)],1)],1)],1)},a=[],l=i("1da1"),s=i("ade3"),o=i("5530"),r=(i("96cf"),i("99af"),i("b0c0"),i("2f62")),d=i("43b3"),c=i("688b"),u=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-row",{staticClass:"mb-2"},[i("b-col",[i("b-row",e._l(e.filtersData.model,(function(t){return i("b-col",{key:t.id,staticClass:"mb-2",attrs:{cols:"12"}},[i("router-link",{attrs:{to:{name:"dict",params:{name:t.key,title:t.multiple}}}},[i("b-button",{staticClass:"w-100"},[e._v(e._s(t.multiple))])],1)],1)})),1)],1),i("b-col",{staticClass:"text-end",attrs:{cols:"8"}},[i("b-row",e._l(e.filtersData.model,(function(t,n){return i("b-col",{key:t.id,staticClass:"mb-2",attrs:{cols:"12"}},[i("b-row",[i("b-col",{staticClass:"position-relative",attrs:{cols:"6"}},[i("label",{staticClass:"text-end lh-lg"},[e._v(e._s(t.label)+":")])]),i("b-col",[i("change-field-modal",{ref:"filter-field-"+t.key,refInFor:!0,attrs:{label:t.text,model:t.key,disabled:t.disabled,resetBtn:!0,rowId:n,items:e.getModelItems(t.key),"no-truncate":!0},on:{updateField:e.onUpdateField,labelChange:e.onLabelChange,resetFilters:e.onResetFilters}})],1)],1)],1)})),1)],1)],1)},p=[],h=(i("7db0"),i("d3b7"),i("c740"),i("4de4"),i("d6cf")),f={components:{ChangeFieldModal:h["a"]},props:["filtersData"],methods:{onUpdateField:function(e){var t=e.id,i=e.fields;this.$emit("applyFilters",{id:t,fields:i})},onLabelChange:function(e){var t=e.id,i=e.model;this.$emit("filterLabelChange",{itemId:t,model:i})},onResetFilters:function(e){this.$emit("resetFilters",e)},getFieldById:function(e,t,i){return this.filtersData.list[t].find((function(t){return t.id==e}))[i]},getModelItems:function(e){var t=this,i=this.filtersData.list[e],n=this.filtersData.model.findIndex((function(t){return t.key==e}));if(0!=n){var a=this.filtersData.model[n-1].key;this.filtersData.state[a]&&""!=this.filtersData.state[a]&&(i=this.filtersData.list[e].filter((function(e){return e[a]==t.filtersData.state[a]})))}return i}}},m=f,b=i("2877"),g=Object(b["a"])(m,u,p,!1,null,null,null),v=g.exports,w=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-row",[i("b-col",[i("b-table",{staticClass:"text-nowrap table-scrollable",style:{height:e.tableHeight},attrs:{id:"table",items:e.itemsData.list,fields:e.localFields,"per-page":e.perPage,"current-page":e.currentPage,busy:e.isBusy,filter:e.filter,"sort-desc":e.SDesc,"sticky-header":e.tableHeight,"no-border-collapse":"","empty-text":"Нет записей","empty-filtered-text":"По вашему запросу не найдено данных","sort-by":"id","head-variant":"light",bordered:"",responsive:"","show-empty":""},on:{"update:sortDesc":function(t){e.SDesc=t},"update:sort-desc":function(t){e.SDesc=t},filtered:e.onFiltered},scopedSlots:e._u([e._l(e.fieldsData.list,(function(t){return{key:"cell("+t.key+")",fn:function(n){return[i("span",{key:t.key},["boolean"==n.field.type?i("boolean-field",{attrs:{state:n.item[t.key],field:t.key,rowId:n.item.id,isEditable:!0},on:{updateField:e.onUpdateField}}):"float"==n.field.type?i("float-field",{attrs:{model:n.item[t.key],field:t.key,rowId:n.item.id,isEditable:!0,currentPopupRef:e.currentPopupRef},on:{editPopupShown:e.onEditPopupShown,updateField:e.onUpdateField}}):"integer"==n.field.type?i("int-field",{attrs:{model:n.item[t.key],field:t.key,rowId:n.item.id,isEditable:!0,currentPopupRef:e.currentPopupRef},on:{editPopupShown:e.onEditPopupShown,updateField:e.onUpdateField}}):"date"==n.field.type?i("date-field",{attrs:{value:n.item[t.key],field:t.key,rowId:n.item.id,isEditable:!0,currentPopupRef:e.currentPopupRef},on:{editPopupShown:e.onEditPopupShown,updateField:e.onUpdateField}}):"selectable"==n.field.type?i("change-field-modal",{staticClass:"mx-2",attrs:{label:e.getFieldById(n.item[t.key],t.key,"name"),model:t.key,rowId:n.item.id,items:e.fieldsData.models[t.key]},on:{updateField:e.onUpdateField}}):"caption"===n.field.type?i("span",[i("text-field",{attrs:{value:n.item[t.key],isEditable:!1}})],1):i("text-field",{attrs:{value:n.item[t.key],field:t.key,rowId:n.item.id,isEditable:!0,currentPopupRef:e.currentPopupRef},on:{editPopupShown:e.onEditPopupShown,updateField:e.onUpdateField}})],1)]}}})),{key:"cell(name)",fn:function(t){return[i("text-field",{attrs:{field:"name",width:"350",fieldType:"textarea",value:t.item["name"],rowId:t.item.id,isEditable:!0,currentPopupRef:e.currentPopupRef},on:{editPopupShown:e.onEditPopupShown,updateField:e.onUpdateField}})]}},{key:"cell(actions)",fn:function(t){return[i("div",{staticClass:"mx-2"},e._l(e.itemsData.actions,(function(n){return i("span",{key:n.id},["route"==n.action?i("router-link",{attrs:{to:e.name+"/"+n.to+"/"+t.item.id}},[i("b-button",{staticClass:"mr-2"},[e._v(e._s(n.label))])],1):e._e(),"copy"===n.action?i("b-button",{staticClass:"mr-2",attrs:{title:n.label},on:{click:function(i){return e.copyWorkGroup({id:t.item.id})}}},[i("b-icon",{attrs:{icon:"back"}})],1):e._e(),"versioning"===n.action?i("router-link",{attrs:{to:e.name+"/versioning/"+t.item.id}},[i("b-button",{staticClass:"mr-2",attrs:{title:n.label}},[i("b-icon",{attrs:{icon:"clock-history"}})],1)],1):e._e(),"delete"==n.action?i("delete-row-btn",{attrs:{label:n.label,rowId:t.item.id},on:{deleteRow:e.onDeleteRow}}):e._e()],1)})),0)]}},{key:"table-busy",fn:function(){return[i("div",{staticClass:"text-center my-2"},[i("b-spinner",{staticClass:"align-middle me-2"}),i("strong",[e._v("Загрузка...")])],1)]},proxy:!0}],null,!0)})],1)],1)},y=[],k=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{class:e.isEditable?"cell-padding":""},[i("b-form-checkbox",{attrs:{value:e.checked,"unchecked-value":e.unchecked,disabled:e.readOnly,size:"lg"},on:{change:e.onUserChange},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}})],1)])},F=[],_={props:["model","readOnly","state","isEditable","field","rowId"],data:function(){return{input:!(null===this||void 0===this||!this.state)&&this.state,checked:!0,unchecked:!1}},methods:{onUserChange:function(e){this.input=e;var t={field:null!==this&&void 0!==this&&this.field?this.field:this.model,value:e};this.$emit("updateField",{id:null!==this&&void 0!==this&&this.rowId?this.rowId:-1,fields:t})}},watch:{state:function(e){this.input=e}}},x=_,C=Object(b["a"])(x,k,F,!1,null,null,null),I=C.exports,R=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.isEditable?i("div",{staticClass:"position-relative"},[i("div",{staticClass:"text d-flex align-items-center"},[i("span",{staticClass:"me-2"},[e._v(e._s(e.model))]),i("b-icon",{staticClass:"cursor-pointer",attrs:{icon:"pencil-square"},on:{click:function(t){return e.showChangeInput(!0)}}})],1),e.editing?i("b-card",{staticClass:"edit-popup shadow",attrs:{"no-body":""}},[i("b-card-header",{staticClass:"d-flex justify-content-between align-items-center"},[i("div",{staticClass:"me-4"},[e._v("Редактирование")]),i("div",[i("b-button",{staticClass:"pill-equal-padding me-2",attrs:{variant:"success",pill:""},on:{click:e.updateField}},[i("b-icon",{attrs:{icon:"check"}})],1),i("b-button",{staticClass:"pill-equal-padding",attrs:{variant:"danger",pill:""},on:{click:function(t){return e.showChangeInput(!1)}}},[i("b-icon",{attrs:{icon:"x"}})],1)],1)]),i("b-form-input",{staticClass:"border-white",attrs:{type:"number",step:"any",placeholder:"Введите число",value:e.input,"no-wheel":!0},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}})],1):e._e()],1):i("span",[i("b-form-input",{attrs:{type:"number",step:"any",placeholder:"Введите число","no-wheel":!0},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}})],1)])},D=[],P=0,O={props:["model","isEditable","field","rowId","readOnly","currentPopupRef"],data:function(){return P+=1,{editing:!1,input:"",popupRef:"float-popup-".concat(P)}},methods:{showChangeInput:function(e){this.input=this.model,this.editing=e,e&&this.$emit("editPopupShown",this.popupRef)},updateField:function(){var e={field:this.field,value:this.input};this.$emit("updateField",{id:this.rowId,fields:e}),this.showChangeInput(!1)}},watch:{input:function(e){if(null===this||void 0===this||!this.isEditable){var t={field:this.model,value:e};this.$emit("updateField",{id:-1,fields:t})}},currentPopupRef:function(e){this.popupRef!=e&&this.showChangeInput(!1)}}},E=O,j=Object(b["a"])(E,R,D,!1,null,null,null),S=j.exports,$=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.isEditable?i("div",{staticClass:"position-relative"},[i("div",{staticClass:"text d-flex align-items-center"},[i("span",{staticClass:"me-2"},[e._v(e._s(e.model))]),i("b-icon",{staticClass:"cursor-pointer",attrs:{icon:"pencil-square"},on:{click:function(t){return e.showChangeInput(!0)}}})],1),e.editing?i("b-card",{staticClass:"edit-popup shadow",attrs:{"no-body":""}},[i("b-card-header",{staticClass:"d-flex justify-content-between align-items-center"},[i("div",{staticClass:"me-4"},[e._v("Редактирование")]),i("div",[i("b-button",{staticClass:"pill-equal-padding me-2",attrs:{variant:"success",pill:""},on:{click:e.updateField}},[i("b-icon",{attrs:{icon:"check"}})],1),i("b-button",{staticClass:"pill-equal-padding",attrs:{variant:"danger",pill:""},on:{click:function(t){return e.showChangeInput(!1)}}},[i("b-icon",{attrs:{icon:"x"}})],1)],1)]),i("b-form-input",{staticClass:"border-white",attrs:{type:"number",step:"1",placeholder:"Введите целое число","no-wheel":!0,value:e.input},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}})],1):e._e()],1):i("span",[i("b-form-input",{attrs:{placeholder:"Введите целое число",type:"number",step:"1","no-wheel":!0},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}})],1)])},M=[],T=0,L={props:["model","isEditable","field","rowId","readOnly","currentPopupRef"],data:function(){return T+=1,{editing:!1,input:"",popupRef:"int-popup-".concat(T)}},methods:{showChangeInput:function(e){this.input=this.model,this.editing=e,e&&this.$emit("editPopupShown",this.popupRef)},updateField:function(){var e={field:this.field,value:this.input};this.$emit("updateField",{id:this.rowId,fields:e}),this.showChangeInput(!1)}},watch:{input:function(e){if(null===this||void 0===this||!this.isEditable){var t={field:this.model,value:e};this.$emit("updateField",{id:-1,fields:t})}},currentPopupRef:function(e){this.popupRef!=e&&this.showChangeInput(!1)}}},U=L,A=Object(b["a"])(U,$,M,!1,null,null,null),N=A.exports,B=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.isEditable?i("div",{staticClass:"position-relative"},[i("div",{staticClass:"text d-flex justify-content-between align-items-center"},[i("span",{staticClass:"me-2"},[e._v(e._s(e.simplifyDate(e.value)))]),i("b-icon",{staticClass:"cursor-pointer",attrs:{icon:"pencil-square"},on:{click:function(t){return e.showChangeInput(!0)}}})],1),e.editing?i("b-card",{staticClass:"edit-popup shadow",attrs:{"no-body":""}},[i("b-card-header",{staticClass:"d-flex justify-content-between align-items-center"},[i("div",{staticClass:"me-4"},[e._v("Редактирование")]),i("div",[i("b-button",{staticClass:"pill-equal-padding me-2",attrs:{variant:"success",disabled:!e.isSelectedDate,pill:""},on:{click:e.updateField}},[i("b-icon",{attrs:{icon:"check"}})],1),i("b-button",{staticClass:"pill-equal-padding",attrs:{variant:"danger",pill:""},on:{click:function(t){return e.showChangeInput(!1)}}},[i("b-icon",{attrs:{icon:"x"}})],1)],1)]),i("b-input-group",[i("b-form-input",{staticClass:"border-white",attrs:{type:"text",placeholder:"ДД.ММ.ГГГГ",autocomplete:"off"},model:{value:e.dateEditInput,callback:function(t){e.dateEditInput=t},expression:"dateEditInput"}}),i("b-input-group-append",[i("b-form-datepicker",{attrs:{"button-only":"",right:"",locale:"ru-RU"},on:{context:e.onContext},model:{value:e.convertedDate,callback:function(t){e.convertedDate=t},expression:"convertedDate"}})],1)],1)],1):e._e()],1):i("div",[i("b-form-datepicker",{attrs:{placeholder:"Выберите дату",locale:"ru-RU","hide-header":!0,readonly:e.readOnly},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}})],1)])},G=[],q=(i("a15b"),i("ac1f"),i("1276"),0),H={props:["model","readOnly","value","isEditable","field","rowId","currentPopupRef"],data:function(){return q+=1,{input:"",editing:!1,selected:"",dateEditInput:"",popupRef:"date-popup-".concat(q)}},methods:{showChangeInput:function(e){this.input=this.value,this.dateEditInput=this.simplifiedDate,this.editing=e,e&&this.$emit("editPopupShown",this.popupRef)},onContext:function(e){this.selected=e.selectedYMD,this.dateEditInput=this.simplifyDate(e.selectedYMD)},updateField:function(){var e={field:this.field,value:this.input};this.$emit("updateField",{id:this.rowId,fields:e}),this.showChangeInput(!1)},simplifyDate:function(e){return new Date(e).toLocaleDateString("ru-RU")}},computed:{isSelectedDate:function(){return!!this.selected},simplifiedDate:function(){var e=this.input?this.input:"12.12.1999";return this.simplifyDate(e)},convertedDate:{get:function(){return this.simplifiedDate.split(".").reverse().join("-")},set:function(e){this.input=e}}},mounted:function(){this.value&&(this.input=this.value)},watch:{input:function(e){if(null===this||void 0===this||!this.isEditable){var t={field:this.model,value:e};this.$emit("updateField",{id:-1,fields:t})}},currentPopupRef:function(e){this.popupRef!=e&&this.showChangeInput(!1)},dateEditInput:function(e){var t=e.split(".").reverse().join("-"),i=new Date(t);i instanceof Date&&!isNaN(i.valueOf())?this.input=t:(console.log("NOT OK:",t),this.selected="")}}},Y=H,J=Object(b["a"])(Y,B,G,!1,null,null,null),K=J.exports,W=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.isEditable?i("div",{staticClass:"position-relative"},[i("div",{staticClass:"text d-flex align-items-center"},[i("span",{staticClass:"me-2"},[e._v(e._s(e.value))]),i("b-icon",{staticClass:"cursor-pointer",attrs:{icon:"pencil-square"},on:{click:function(t){return e.showChangeInput(!0)}}})],1),e.editing?i("b-card",{staticClass:"edit-popup shadow",attrs:{"no-body":""}},[i("b-card-header",{staticClass:"d-flex justify-content-between align-items-center"},[i("div",{staticClass:"me-4"},[e._v("Редактирование")]),i("div",[i("b-button",{staticClass:"pill-equal-padding me-2",attrs:{variant:"success",pill:""},on:{click:e.updateField}},[i("b-icon",{attrs:{icon:"check"}})],1),i("b-button",{staticClass:"pill-equal-padding",attrs:{variant:"danger",pill:""},on:{click:function(t){return e.showChangeInput(!1)}}},[i("b-icon",{attrs:{icon:"x"}})],1)],1)]),"textarea"==e.fieldType?i("b-form-textarea",{staticClass:"border-white",style:e.width?"min-width:"+e.width+"px":"",attrs:{type:"text",rows:"3","max-rows":"6",value:e.input},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}}):i("b-form-input",{staticClass:"border-white",style:e.width?"min-width:"+e.width+"px":"",attrs:{type:"text",placeholder:"Введите текст",value:e.input},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}})],1):e._e()],1):i("span",{staticClass:"text"},[e._v(" "+e._s(e.value)+" ")])])},z=[],Q=0,V={props:["value","isEditable","field","rowId","readOnly","currentPopupRef","width","fieldType"],data:function(){return Q+=1,{input:"",editing:!1,popupRef:"text-popup-".concat(Q)}},methods:{showChangeInput:function(e){this.input=this.value,this.editing=e,e&&this.$emit("editPopupShown",this.popupRef)},updateField:function(){var e={field:this.field,value:this.input};this.$emit("updateField",{id:this.rowId,fields:e}),this.showChangeInput(!1)}},watch:{input:function(e){if(null===this||void 0===this||!this.isEditable){var t={field:this.model,value:e};this.$emit("updateField",{id:-1,fields:t})}},currentPopupRef:function(e){this.popupRef!=e&&this.showChangeInput(!1)}}},X=V,Z=Object(b["a"])(X,W,z,!1,null,null,null),ee=Z.exports,te=i("46c2"),ie={components:{BooleanField:I,FloatField:S,IntField:N,DateField:K,TextField:ee,ChangeFieldModal:h["a"],DeleteRowBtn:te["a"]},props:["parent","itemsData","fieldsData","isBusy","filter","perPage","currentPage","name","tableSpacing"],data:function(){return{SDesc:!1,currentPopupRef:null}},computed:{localFields:function(){var e=this;return this.parent?this.fieldsData.list.filter((function(t){return t.key!=e.parent})):this.fieldsData.list},tableHeight:function(){return"calc(100vh - ".concat(this.tableSpacing,"px)")}},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(r["b"])(["deleteRow","copyWorkGroup"])),Object(r["d"])(["updateTableItem"])),{},{onUpdateField:function(e){var t=e.id,i=e.fields,n=i.field,a=i.value;console.log("[upd]",this.name,t,n,a),this.updateTableItem({collection:this.name,id:t,field:n,value:a})},onEditPopupShown:function(e){this.currentPopupRef=e},onDeleteRow:function(e){this.deleteRow({table_name:this.name,row_id:e})},getFieldById:function(e,t,i){return this.fieldsData.models[t]?this.fieldsData.models[t].find((function(t){return t.id==e}))[i]:""},onFiltered:function(e,t){this.$emit("filtered",e,t)}})},ne=ie,ae=Object(b["a"])(ne,w,y,!1,null,null,null),le=ae.exports,se=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-pagination",{attrs:{"total-rows":e.rows,"per-page":e.perPage,"first-number":"","last-number":"","aria-controls":"table"},model:{value:e.currentPageLocal,callback:function(t){e.currentPageLocal=t},expression:"currentPageLocal"}})},oe=[],re={props:["rows","perPage","currentPage"],data:function(){return{currentPageLocal:this.currentPage}},watch:{currentPage:function(e){this.currentPageLocal=e},currentPageLocal:function(e){this.$emit("pageChange",e)}}},de=re,ce=Object(b["a"])(de,se,oe,!1,null,null,null),ue=ce.exports,pe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.readOnly?i("b-button",{attrs:{variant:"primary"}},[e._v(" Импорт ")]):i("add-new-row",{attrs:{parent:e.parent,parentId:e.parentId,fields:e.fields,fieldsModels:e.fieldsModels,title:"Добавление записи"},on:{addNewRow:e.onAddNewRow}})],1)},he=[],fe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.showAddModal(t.target)}}},[e._v(" Добавить ")]),i("b-modal",{attrs:{id:e.addModal.id,title:e.addModal.title,centered:""},on:{hide:e.resetAddModal},scopedSlots:e._u([{key:"modal-footer",fn:function(t){var n=t.ok,a=t.cancel;return[i("b-button",{attrs:{variant:"danger"},on:{click:function(e){return a()}}},[e._v(" Отмена ")]),i("b-button",{attrs:{variant:"success"},on:{click:function(t){return e.addNewRow(n)}}},[e._v(" OK ")])]}}])},e._l(e.localFields,(function(t){return i("b-row",{key:t.id,staticClass:"py-2"},["actions"!=t.key?i("b-col",{staticClass:"position-relative d-flex align-items-center"},[i("label",{staticClass:"mb-0"},[e._v(e._s(t.label)+":")])]):e._e(),"actions"!=t.key?i("b-col",{attrs:{cols:"8"}},[t.type&&"selectable"==t.type?i("change-field-modal",{ref:"change-field-"+t.key,refInFor:!0,attrs:{rowId:"-1",label:"Не выбрано",model:t.key,items:e.fieldsModels[t.key],"no-truncate":!0},on:{updateField:e.onUpdateField,labelChange:e.onLabelChange}}):t.type&&"float"==t.type?i("float-field",{attrs:{model:t.key},on:{updateField:e.onUpdateField}}):t.type&&"integer"==t.type?i("int-field",{attrs:{model:t.key},on:{updateField:e.onUpdateField}}):t.type&&"boolean"==t.type?i("boolean-field",{attrs:{model:t.key},on:{updateField:e.onUpdateField}}):t.type&&"date"==t.type?i("date-field",{attrs:{model:t.key},on:{updateField:e.onUpdateField}}):i("b-form-input",{attrs:{placeholder:"Введите текст"},model:{value:e.addModal.fields[t.key],callback:function(i){e.$set(e.addModal.fields,t.key,i)},expression:"addModal.fields[field.key]"}})],1):e._e()],1)})),1)],1)},me=[],be=(i("159b"),i("b64b"),i("54c2")),ge={components:{ChangeFieldModal:h["a"],FloatField:S,IntField:N,BooleanField:I,DateField:K},props:["title","fields","fieldsModels","parent","parentId"],data:function(){return{API:new be["a"](this),addModal:{id:"add-row-modal",title:this.title,fields:{}}}},computed:{localFields:function(){var e=this;return this.parent?this.fields.filter((function(t){return t.key!=e.parent})):this.fields}},methods:{showAddModal:function(e){this.$bvModal.show(this.addModal.id,e),window.addEventListener("keypress",this.keyAction)},resetAddModal:function(){for(var e in this.addModal.fields)this.addModal.fields[e]="",delete this.addModal.fields[e];window.removeEventListener("keypress",this.keyAction)},onLabelChange:function(e){var t=e.id,i=e.model;this.$refs["change-field-".concat(i)][0].labelReplacement=this.getFieldById(t,i,"name")},onUpdateField:function(e){e._id;var t=e.fields;this.$set(this.addModal.fields,t.field,t.value)},addNewRow:function(e){var t=this;console.log(e);var i={};Object.keys(this.addModal.fields).forEach((function(e){i[e]=t.addModal.fields[e]})),this.parent&&(i[this.parent]=this.parentId),this.$emit("addNewRow",i),e()},getFieldById:function(e,t,i){return this.fieldsModels[t].find((function(t){return t.id==e}))[i]},keyAction:function(e){var t=this;"Enter"===e.key&&e.target.classList.contains("modal-content")&&this.addNewRow((function(){t.$bvModal.hide(t.addModal.id)}))}},destroyed:function(){window.removeEventListener("keypress",this.keyAction)}},ve=ge,we=Object(b["a"])(ve,fe,me,!1,null,null,null),ye=we.exports,ke={components:{AddNewRow:ye},props:["parent","parentId","readOnly","fields","fieldsModels"],methods:{onAddNewRow:function(e){this.$emit("addNewRow",e)}}},Fe=ke,_e=Object(b["a"])(Fe,pe,he,!1,null,null,null),xe=_e.exports,Ce=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[0==e.items.list.length?i("h5",[e._v("Нет доступных записей!")]):i("b-card",{staticClass:"mb-4",attrs:{header:"Выберите из списка"}},e._l(e.items.list,(function(t){return i("b-form-checkbox",{key:t.id,attrs:{checked:t.checked},on:{change:function(i){return e.changeSelection(i,t.id)}}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)},Ie=[],Re={props:["items","fields","id","name"],data:function(){return{parent_id:this.id,child_table:this.fields.list[0].key,parent_table:this.fields.list[1].key}},methods:Object(o["a"])(Object(o["a"])({},Object(r["b"])(["updateSelection"])),{},{changeSelection:function(e,t){this.updateSelection({collection:this.name,parent:this.parent_table,parent_id:this.parent_id,child:this.child_table,child_id:t,value:e})}})},De=Re,Pe=Object(b["a"])(De,Ce,Ie,!1,null,null,null),Oe=Pe.exports,Ee=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[0==e.items.list.length?i("h5",[e._v("Нет доступных записей!")]):e._l(e.radioGroups,(function(t,n){return i("b-card",{key:n,staticClass:"mb-4",attrs:{header:e.getGroupTitle(n)}},[i("b-form-group",{staticClass:"mb-0"},[i("RadioGroupElement",{attrs:{id:e.id,name:e.name,group:t,index:n,selection:e.groupSelections[n],parent:e.parent_table,child:e.child_table}})],1)],1)}))],2)},je=[],Se=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-form-radio-group",{attrs:{stacked:""},on:{change:function(t){return e.changeSelection(t,e.group[e.index].work_stage)}},model:{value:e.localSelection,callback:function(t){e.localSelection=t},expression:"localSelection"}},e._l(e.group,(function(t){return i("b-form-radio",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)},$e=[],Me={props:["id","name","group","index","selection","parent","child"],data:function(){return{localSelection:this.selection,prev:null,current:null}},methods:Object(o["a"])(Object(o["a"])({},Object(r["b"])(["updateRadioSelection"])),{},{changeSelection:function(e,t){console.log("[changeSelection() radio update]",e,t),this.updateRadioSelection({collection:this.name,parent:this.parent,parent_id:this.id,child:this.child,child_id:this.id,prev:this.prev,current:this.current})}}),watch:{localSelection:function(e,t){this.prev=t,this.current=e}}},Te=Me,Le=Object(b["a"])(Te,Se,$e,!1,null,null,null),Ue=Le.exports,Ae={props:["items","groupField","fields","id","name"],components:{RadioGroupElement:Ue},data:function(){return{parent_id:this.id,parent_table:this.fields.list[0].key,child_table:this.fields.list[1].key}},methods:Object(o["a"])(Object(o["a"])({},Object(r["b"])(["getGroupTitles"])),{},{getGroupTitle:function(e){var t=this;return this.groupTitles.filter((function(i){return i.id===t.radioGroups[e][0][t.groupField]}))[0]["name"]}}),computed:Object(o["a"])(Object(o["a"])({},Object(r["c"])(["groupTitles"])),{},{radioGroups:function(){var e=[];return this.items.list.forEach((function(t){e[t.work_stage]||(e[t.work_stage]=[{id:-1,name:"Не выбрано",work_stage:t.work_stage}]),e[t.work_stage].push(t)})),e.filter(Boolean)},groupSelections:function(){for(var e=[],t=0;t<this.radioGroups.length;t++){var i=this.radioGroups[t].filter((function(e){return 1==e.checked})),n=0==i.length?-1:i[0].id;e[t]=n}return e}}),mounted:function(){this.getGroupTitles({collection:this.groupField})}},Ne=Ae,Be=Object(b["a"])(Ne,Ee,je,!1,null,null,null),Ge=Be.exports,qe={components:{Title:d["a"],SearchBar:c["a"],Filters:v,Table:le,Pagination:ue,AddDataBtn:xe,SelectGroup:Oe,RadioGroup:Ge},props:["name","id","parent"],data:function(){return{searchFilter:null,perPage:150,currentPage:1,isReadOnly:!1,tableSpacing:0,searchedRows:0}},computed:Object(o["a"])(Object(o["a"])({},Object(r["c"])(["title","parent_name","mode","groupField","isBusy","isFiltered","itemsData","fieldsData","selectableFields","itemRowsLength","filtersData","filterParams","historyTableFieldsData"])),{},{localTitle:function(){return"many_to_many"===this.mode&&this.parent?(this.getParentNameById({table_name:this.parent,id:this.id}),"".concat(this.title.substring(0,this.title.lastIndexOf(" "))," ").concat(this.parent_name)):this.title},localItemRowsLength:function(){return this.searchFilter?this.searchedRows:this.itemRowsLength},compiledParams:function(){var e={};return null!==this&&void 0!==this&&this.parent&&(e=Object(s["a"])({},this.parent,this.id)),null!=this.mode&&(e["mode"]=this.mode,e["child"]=this.fieldsData.list[0].key),null!=this.groupField&&(e["child"]=this.fieldsData.list[1].key),e}}),methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(r["b"])(["getItems","getFieldsModels","getFiltersItems","resetFiltersFromId","getTableInfo","applyFilters","addNewRow","getParentNameById","getHistoryTableData","getHistoryItemsData"])),Object(r["d"])(["updateFieldsList","resetItemsActions","updateItemsActions","resetFiltersModel","updateFiltersModel","resetFilterState","addTableItem","updateObj","updateFilterLabel"])),{},{onApplyFilters:function(e){e._id;var t=e.fields;this.applyFilters(t),this.getItems({name:[this.name],params:this.filterParams})},resetFilters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.resetFiltersFromId(e);var t=this.compiledParams;0!=e&&(t=Object(o["a"])(Object(o["a"])({},t),this.filterParams)),this.getItems({name:[this.name],params:t})},onTableSearched:function(e,t){this.searchedRows=t},onResetFilters:function(e){this.resetFilters(e)},onFilterChange:function(e){this.searchFilter=e,this.currentPage=1},onFilterLabelChange:function(e){var t=e.itemId,i=e.model;this.updateFilterLabel({itemId:t,model:i})},onPageChange:function(e){this.currentPage=e},onAddNewRow:function(e){this.resetFilters(0),this.addNewRow({table_name:this.name,row:e})},calcTableHeight:function(){var e=62,t=56,i=24,n=62,a=50,l=8,s=null===this.mode,o=!!this.filtersData.model.length;this.tableSpacing=t+(s?e:0)+(o?a*this.filtersData.model.length:0)+(o?l:0)+i+n},init:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.searchFilter=null,"versioning"!==e.name){t.next=8;break}return t.next=4,e.getHistoryTableData({table_name:e.parent});case 4:return t.next=6,e.getHistoryItemsData({table_name:e.parent,row_id:e.id});case 6:t.next=12;break;case 8:return t.next=10,e.getTableInfo({name:e.name});case 10:return t.next=12,e.getItems({name:e.name,params:e.compiledParams});case 12:case"end":return t.stop()}}),t)})))()}}),mounted:function(){this.init()},beforeUpdate:function(){this.calcTableHeight()},watch:{name:function(){this.init()},"filtersData.model":function(){this.calcTableHeight()}}},He=qe,Ye=Object(b["a"])(He,n,a,!1,null,null,null);t["default"]=Ye.exports},"8aa5":function(e,t,i){"use strict";var n=i("6547").charAt;e.exports=function(e,t,i){return t+(i?n(e,t).length:1)}},a15b:function(e,t,i){"use strict";var n=i("23e7"),a=i("e330"),l=i("44ad"),s=i("fc6a"),o=i("a640"),r=a([].join),d=l!=Object,c=o("join",",");n({target:"Array",proto:!0,forced:d||!c},{join:function(e){return r(s(this),void 0===e?",":e)}})},d784:function(e,t,i){"use strict";i("ac1f");var n=i("e330"),a=i("6eeb"),l=i("9263"),s=i("d039"),o=i("b622"),r=i("9112"),d=o("species"),c=RegExp.prototype;e.exports=function(e,t,i,u){var p=o(e),h=!s((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),f=h&&!s((function(){var t=!1,i=/a/;return"split"===e&&(i={},i.constructor={},i.constructor[d]=function(){return i},i.flags="",i[p]=/./[p]),i.exec=function(){return t=!0,null},i[p](""),!t}));if(!h||!f||i){var m=n(/./[p]),b=t(p,""[e],(function(e,t,i,a,s){var o=n(e),r=t.exec;return r===l||r===c.exec?h&&!s?{done:!0,value:m(t,i,a)}:{done:!0,value:o(i,t,a)}:{done:!1}}));a(String.prototype,e,b[0]),a(c,p,b[1])}u&&r(c[p],"sham",!0)}}}]);
//# sourceMappingURL=dict.ddf47e37.js.map